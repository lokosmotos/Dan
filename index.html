<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Year 2 Alpha Study Buddy</title>
    <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/babel-standalone@7.22.5/babel.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background-color: #f0f9ff;
            color: #1e3a8a;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .card {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        .btn {
            background-color: #3b82f6;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .btn:hover {
            background-color: #2563eb;
        }
        .subject-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        .subject-card {
            background-color: #dbeafe;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
        }
        .subject-card:hover {
            background-color: #bfdbfe;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
            visibility: hidden;
        }
        .modal.show {
            visibility: visible;
        }
        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        .close-btn {
            float: right;
            font-size: 24px;
            cursor: pointer;
        }
        .question {
            margin-bottom: 15px;
        }
        .answer-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #d1d5db;
            border-radius: 5px;
        }
        .jawi-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        .jawi-card {
            background-color: #f3e8ff;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }
        .planner-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .planner-table th, .planner-table td {
            border: 1px solid #d1d5db;
            padding: 8px;
            text-align: left;
        }
        .planner-table th {
            background-color: #bfdbfe;
        }
        .completed {
            text-decoration: line-through;
            color: #6b7280;
        }
        @media (max-width: 600px) {
            .subject-list {
                grid-template-columns: 1fr;
            }
            .jawi-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const subjects = [
            {
                name: "Science",
                content: (
                    <div>
                        <h2 className="text-2xl mb-4">Science</h2>
                        <h3 className="text-xl mb-2">Sense Organs</h3>
                        <p>Eyes: See colors, shapes<br />Ears: Hear sounds<br />Nose: Smell odors<br />Tongue: Taste sweet, sour<br />Skin: Feel hot, cold</p>
                        <h3 className="text-xl mb-2">Living vs Non-Living</h3>
                        <p>Living: Grow, breathe (e.g., cat, tree)<br />Non-Living: Don’t grow (e.g., rock, chair)</p>
                        <h3 className="text-xl mb-2">Science Room Rules</h3>
                        <p>Follow teacher, wear goggles, no running, no eating, clean spills</p>
                        <h3 className="text-xl mb-2">Human</h3>
                        <p>Reproduction: Babies grow in womb (~9 months)<br />Growth: Baby to Child to Teen to Adult to Old Person<br />Changes: Grow taller, lose teeth<br />Traits: Eye color, hair from parents</p>
                    </div>
                )
            },
            {
                name: "Pendidikan Islam",
                content: (
                    <div>
                        <h2 className="text-2xl mb-4">Pendidikan Islam</h2>
                        <h3 className="text-xl mb-2">Surah An-Nas</h3>
                        <p>Surah 114, 6 verses. Example: قُلْ أَعُوذُ بِرَبِّ النَّاسِ (Say: I seek refuge...)</p>
                        <h3 className="text-xl mb-2">Mad Asli</h3>
                        <p>Stretch vowels 2 beats (e.g., “nās” in “maliki-n-nās”)</p>
                        <h3 className="text-xl mb-2">20 Sifat Wajib</h3>
                        <p>Wujud: Allah exists<br />Qudrah: All-powerful<br />Ilm: Knows all<br />Hayah: Ever-living<br />Sami’an: All-hearing</p>
                        <h3 className="text-xl mb-2">Istinjak</h3>
                        <p>Clean with water/tissue (left hand). Du’a: “Bismillah, Allahumma inni a‘udhu...”</p>
                        <h3 className="text-xl mb-2">Sirah</h3>
                        <p>Signs: Quran, moon splitting, Al-Amin, seal on back</p>
                        <h3 className="text-xl mb-2">Adab Makan</h3>
                        <p>Say “Bismillah,” right hand, small bites, “Alhamdulillah” after</p>
                        <h3 className="text-xl mb-2">Jawi Suku Kata</h3>
                        <p>Examples: بَا (ba), سِي (si), كُو (ku)</p>
                    </div>
                )
            },
            {
                name: "Bahasa Melayu",
                content: (
                    <div>
                        <h2 className="text-2xl mb-4">Bahasa Melayu</h2>
                        <h3 className="text-xl mb-2">Imlak</h3>
                        <p>Write dictated words (e.g., buku, kucing)</p>
                        <h3 className="text-xl mb-2">Lisan</h3>
                        <p>Speak clearly (e.g., “Saya suka membaca”)</p>
                        <h3 className="text-xl mb-2">Kata Nama</h3>
                        <p>Am: buku, kereta<br />Khas: Ali, Melaka</p>
                        <h3 className="text-xl mb-2">Kata Adjektif</h3>
                        <p>Sifat: baik<br />Bentuk: bulat<br />Ukuran: besar<br />Warna: merah</p>
                        <h3 className="text-xl mb-2">Penjodoh Bilangan</h3>
                        <p>Sebatang pensil, seekor kucing</p>
                        <h3 className="text-xl mb-2">Isi Tersurat/Tersirat</h3>
                        <p>Tersurat: Direct info<br />Tersirat: Hidden meaning</p>
                        <h3 className="text-xl mb-2">Bina Ayat</h3>
                        <p>Example: “Saya makan nasi”</p>
                    </div>
                )
            },
            {
                name: "English",
                content: (
                    <div>
                        <h2 className="text-2xl mb-4">English</h2>
                        <h3 className="text-xl mb-2">Days of the Week</h3>
                        <p>Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday</p>
                        <h3 className="text-xl mb-2">Punctuation</h3>
                        <p>Capital for names, sentence starts (e.g., “Ali”)</p>
                        <h3 className="text-xl mb-2">Free Time Activities</h3>
                        <p>Play football, read books, watch TV</p>
                        <h3 className="text-xl mb-2">Present Simple Questions</h3>
                        <p>Example: “Do you play?”</p>
                        <h3 className="text-xl mb-2">Healthy/Unhealthy</h3>
                        <p>Healthy: Fruits, exercise<br />Unhealthy: Sweets, too much TV</p>
                    </div>
                )
            },
            {
                name: "Muzik",
                content: (
                    <div>
                        <h2 className="text-2xl mb-4">Muzik</h2>
                        <h3 className="text-xl mb-2">Nyanyian</h3>
                        <p>Sing clearly (e.g., “Rasa Sayang”)</p>
                        <h3 className="text-xl mb-2">Tempo</h3>
                        <p>Fast, slow, medium speeds</p>
                        <h3 className="text-xl mb-2">Sebutan Irama</h3>
                        <p>Say rhythms (e.g., “ta-ta-ti-ti”)</p>
                    </div>
                )
            },
            {
                name: "Seni Visual",
                content: (
                    <div>
                        <h2 className="text-2xl mb-4">Seni Visual</h2>
                        <p>Choose one:</p>
                        <ul>
                            <li>Menggambar: Draw vegetables/fruits</li>
                            <li>Membuat Corak: Fold/cut paper for decoration</li>
                            <li>Membentuk: Shape clay into cup/box</li>
                        </ul>
                    </div>
                )
            },
            {
                name: "Matematik",
                content: (
                    <div>
                        <h2 className="text-2xl mb-4">Matematik</h2>
                        <h3 className="text-xl mb-2">Addition</h3>
                        <p>Example: 12 + 5 = 17</p>
                        <h3 className="text-xl mb-2">Subtraction</h3>
                        <p>Example: 15 - 5 = 10</p>
                    </div>
                )
            },
            {
                name: "PJPK",
                content: (
                    <div>
                        <h2 className="text-2xl mb-4">PJPK</h2>
                        <p>Exercises: Run, jump, throw<br />Health: Wash hands, brush teeth</p>
                    </div>
                )
            }
        ];

        const jawiWorksheet = [
            { task: "Write بَا (ba) 3 times", answer: "بَا بَا بَا" },
            { task: "Write سِي (si) 3 times", answer: "سِي سِي سِي" },
            { task: "Match: بِي", options: ["ku", "bi", "sa"], answer: "bi" },
            { task: "Read and write مَكَنْ (makan) 5 times", answer: "مَكَنْ مَكَنْ مَكَنْ مَكَنْ مَكَنْ" }
        ];

        function App() {
            const [selectedSubject, setSelectedSubject] = React.useState(null);
            const [showQuestions, setShowQuestions] = React.useState(false);
            const [showJawi, setShowJawi] = React.useState(false);
            const [showPlanner, setShowPlanner] = React.useState(false);
            const [questions, setQuestions] = React.useState({});
            const [planner, setPlanner] = React.useState([]);
            const [answers, setAnswers] = React.useState({});
            const [completedTasks, setCompletedTasks] = React.useState({});

            React.useEffect(() => {
                fetch('/api/questions')
                    .then(response => response.json())
                    .then(data => setQuestions(data))
                    .catch(error => console.error('Error fetching questions:', error));

                fetch('/api/planner')
                    .then(response => response.json())
                    .then(data => setPlanner(data))
                    .catch(error => console.error('Error fetching planner:', error));

                fetch('/api/completed-tasks')
                    .then(response => response.json())
                    .then(data => setCompletedTasks(data))
                    .catch(error => console.error('Error fetching completed tasks:', error));
            }, []);

            const openModal = (subject) => {
                setSelectedSubject(subject);
                setShowQuestions(false);
                setShowJawi(false);
                setShowPlanner(false);
            };

            const closeModal = () => {
                setSelectedSubject(null);
            };

            const checkAnswer = (index, correctAnswer) => {
                if (answers[index]?.toLowerCase().trim() === correctAnswer.toLowerCase().trim()) {
                    alert("Correct! Great job!");
                } else {
                    alert("Try again! Hint: Check the answer carefully.");
                }
            };

            const handleAnswerChange = (index, value) => {
                const newAnswers = {};
                Object.assign(newAnswers, answers);
                newAnswers[index] = value;
                setAnswers(newAnswers);
            };

            const toggleTaskCompletion = (index) => {
                fetch('/api/complete-task', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ index })
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.status === 'success') {
                            const newTasks = {};
                            Object.assign(newTasks, completedTasks);
                            newTasks[index] = true;
                            setCompletedTasks(newTasks);
                        }
                    })
                    .catch(error => console.error('Error completing task:', error));
            };

            return (
                <div className="container">
                    <h1 className="text-3xl text-center mb-6">Year 2 Alpha Study Buddy</h1>
                    <div className="card">
                        <h2 className="text-2xl mb-4">Choose a Subject</h2>
                        <div className="subject-list">
                            {subjects.map((subject, index) => (
                                <div
                                    key={index}
                                    className="subject-card"
                                    onClick={() => openModal(subject)}
                                >
                                    <h3 className="text-lg">{subject.name}</h3>
                                </div>
                            ))}
                        </div>
                    </div>
                    <div className="card">
                        <h2 className="text-2xl mb-4">Practice Zone</h2>
                        <button className="btn mr-4" onClick={() => { setShowQuestions(true); setSelectedSubject(null); }}>
                            Practice Questions
                        </button>
                        <button className="btn mr-4" onClick={() => { setShowJawi(true); setSelectedSubject(null); }}>
                            Jawi Worksheet
                        </button>
                        <button className="btn" onClick={() => { setShowPlanner(true); setSelectedSubject(null); }}>
                            Study Planner
                        </button>
                    </div>

                    {selectedSubject && (
                        <div className="modal show">
                            <div className="modal-content">
                                <span className="close-btn" onClick={closeModal}>×</span>
                                {selectedSubject.content}
                            </div>
                        </div>
                    )}

                    {showQuestions && (
                        <div className="modal show">
                            <div className="modal-content">
                                <span className="close-btn" onClick={() => setShowQuestions(false)}>×</span>
                                <h2 className="text-2xl mb-4">Practice Questions</h2>
                                {Object.keys(questions).map((subject) => (
                                    <div key={subject}>
                                        <h3 className="text-xl mb-2">{subject}</h3>
                                        {questions[subject].map((q, index) => (
                                            <div key={index} className="question">
                                                <p>{q.question}</p>
                                                <input
                                                    type="text"
                                                    className="answer-input"
                                                    value={answers[`${subject}-${index}`] || ''}
                                                    onChange={(e) => handleAnswerChange(`${subject}-${index}`, e.target.value)}
                                                />
                                                <button
                                                    className="btn mt-2"
                                                    onClick={() => checkAnswer(`${subject}-${index}`, q.answer)}
                                                >
                                                    Check Answer
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    {showJawi && (
                        <div className="modal show">
                            <div className="modal-content">
                                <span className="close-btn" onClick={() => setShowJawi(false)}>×</span>
                                <h2 className="text-2xl mb-4">Jawi Suku Kata Worksheet</h2>
                                <div className="jawi-grid">
                                    {jawiWorksheet.map((task, index) => (
                                        <div key={index} className="jawi-card">
                                            <p>{task.task}</p>
                                            {task.options ? (
                                                <select
                                                    className="answer-input"
                                                    value={answers[`jawi-${index}`] || ''}
                                                    onChange={(e) => handleAnswerChange(`jawi-${index}`, e.target.value)}
                                                >
                                                    <option value="">Choose</option>
                                                    {task.options.map((opt, i) => (
                                                        <option key={i} value={opt}>{opt}</option>
                                                    ))}
                                                </select>
                                            ) : (
                                                <input
                                                    type="text"
                                                    className="answer-input"
                                                    value={answers[`jawi-${index}`] || ''}
                                                    onChange={(e) => handleAnswerChange(`jawi-${index}`, e.target.value)}
                                                />
                                            )}
                                            <button
                                                className="btn mt-2"
                                                onClick={() => checkAnswer(`jawi-${index}`, task.answer)}
                                            >
                                                Check
                                            </button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}

                    {showPlanner && (
                        <div className="modal show">
                            <div className="modal-content">
                                <span className="close-btn" onClick={() => setShowPlanner(false)}>×</span>
                                <h2 className="text-2xl mb-4">Study Planner</h2>
                                <table className="planner-table">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Subjects</th>
                                            <th>Activities</th>
                                            <th>Done</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {planner.map((day, index) => (
                                            <tr key={index} className={completedTasks[index] ? 'completed' : ''}>
                                                <td>{day.date}</td>
                                                <td>{day.subjects.join(', ')}</td>
                                                <td>{day.activities.join(', ')}</td>
                                                <td>
                                                    <input
                                                        type="checkbox"
                                                        checked={completedTasks[index] || false}
                                                        onChange={() => toggleTaskCompletion(index)}
                                                    />
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>